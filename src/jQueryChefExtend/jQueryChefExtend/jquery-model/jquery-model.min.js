function escapeRegExp(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}String.prototype.startsWith||(String.prototype.startsWith=function(n,t){return this.substring(!t||t<0?0:+t,n.length)===n});String.prototype.endsWith||(String.prototype.endsWith=function(n,t){return(t===undefined||t>this.length)&&(t=this.length),this.substring(t-n.length,t)===n});Array.prototype.contains||(Array.prototype.contains=function(n,t){const r=this,u=r.length;let i=-1;if(t===undefined){while(++i!==u)if(i in r&&n(r[i],i,r))return!0}else while(++i!==u)if(i in r&&n.call(t,r[i],i,r))return!0;return!1}),function(n){const e=/[^\.\|]\.[^\.\|]/,h=/`([^`]+)`/,c=/\{([^\{\}]+)\}/,l=/\|[^\|]+/,a=/,(value|value-number):([^:,]+)/,v=/^(value|value-number):([^:,]+)/,y=/([^:,]+):(`[^`]+`|[^:,]+)/g,p=/\|([^\s]+)$/,w=/\|([^\s]+) \? (.+)$/,b=/^'([^']+)'$/,u=new Map,f=function(n,t){const i="[c-model='"+t+"'],[c-model-number='"+t+"'],[c-model-dazzle*='value:"+t+"'],[c-model-dazzle*='value-number:"+t+"']";return n.find(i).addBack(i)},d=function(n){return n.includes("(")||n.includes(")")?undefined:!n.startsWith(".")&&(n=new Function(`return window.${n};`)(),typeof n!="function")?undefined:n},k=function(n){if(u.has(n))return u.get(n);let t=undefined;if(t=p.exec(n)){let i=t[1];if(i.includes("(")||i.includes(")")||!i.startsWith(".")&&(i=new Function(`return window.${i};`)(),typeof i!="function"))return undefined;const r={method:i,arguments:[]};return u.set(n,r),r}if(t=w.exec(n)){let i=t[1];if(i.includes("(")||i.includes(")")||!i.startsWith(".")&&(i=new Function(`return window.${i};`)(),typeof i!="function"))return undefined;const f=t[2].split(" & ").reduce((n,t)=>{let i=undefined;return(i=b.exec(t))?n.push(i[1]):n.push(Number(t)),n},[]),r={method:i,arguments:f};return u.set(n,r),r}return undefined},o=function(n){let t=undefined;do if(t=l.exec(n.name)){const i=k(t[0]);i&&n.filters.push(i);n.name=n.name.replace(t[0],"")}while(t)},s=function(n){n.filters.length&&(n.value=n.filters.reduce((n,t)=>{if(typeof t.method=="function")return t.method.call(null,n,...t.arguments);if(t.method.startsWith(".")){if(n==undefined)return n;const i=t.method.substring(1);if(n[i])return n[i].apply(n,t.arguments)}return n},n.value))},t=function(n,i){if(i==undefined)return undefined;const u=h.exec(n);if(u){let n=undefined,r=u[1];do if(n=c.exec(r)){const u={name:n[1],filters:[]};if(o(u),u.value=t(u.name,i),s(u),u.value==undefined)return undefined;r=r.replace(new RegExp(escapeRegExp(n[0]),"g"),u.value)}while(n);return r}if(e.test(n)){const r=n.indexOf(".");return t(n.substr(r+1),i[n.substr(0,r)])}const r={name:n,filters:[]};return o(r),r.value=i[r.name],s(r),r.value},i=function(n,t,r){if(e.test(n)){const f=n.indexOf("."),u=n.substr(0,f);r[u]==undefined&&(r[u]={});i(n.substr(f+1),t,r[u])}else r[n]=t},r=function(n){return n==undefined?undefined:n.constructor===Function?n():n};n.expr[":"].attrStartsWith=n.expr.createPseudo(function(n){return function(t){for(let i=t.attributes.length-1;i>=0;i--)if(t.attributes[i].name.startsWith(n))return!0;return!1}});n.expr[":"].attrEndsWith=n.expr.createPseudo(function(n){return function(t){for(let i=t.attributes.length-1;i>=0;i--)if(t.attributes[i].name.endsWith(n))return!0;return!1}});n.extend({jqModel:{toNumber:function(n){return n===""?undefined:n.trim().length<1?undefined:isNaN(n)?undefined:Number(n)}}});n.fn.extend({getModelValue:function(){return this.is(":radio")?n("input[type='radio'][name='"+this.attr("name")+"']:checked").val():this.is(":checkbox")?this.attr("value")?this.prop("checked")?this.val():undefined:this.prop("checked"):this.is("[contenteditable='true']")?this.text():this.val()},setModelValue:function(t){this.is(":radio")?n("input[type='radio'][name='"+this.attr("name")+"']").prop("checked",!1).filter("[value='"+t+"']").prop("checked",!0):this.is(":checkbox")?this.attr("value")?this.prop("checked",this.val()===t.toString()):this.prop("checked",t):this.val(t)},model:function(u,f,e,o){const s=this.find(":attrStartsWith('c-model')").addBack(":attrStartsWith('c-model')");if(s.length===0)return undefined;if(u){if(u.constructor===String){const n={};n[u]=f;u=n}else u.constructor===Object&&(e=f);let i=undefined;e&&e.constructor===Object&&(i=e.beforeSet,e=e.afterSet);i&&i.constructor===Function&&i(this,u,o);n.each(s,function(i,f){for(let i=f.attributes.length-1;i>=0;i--){const o=f.attributes[i];if(o.name.startsWith("c-model")){const e=n(f);if(o.name==="c-model-dazzle"){let n=undefined;do if(n=y.exec(o.value)){const f=n[1],o=n[2],i=t(o,u);if(i!==undefined)switch(f){case"text":e.text(r(i));break;case"html":e.html(r(i));break;case"value":case"value-number":e.is(":input")?e.setModelValue(i):e.attr("value",i);break;default:e.attr(f,r(i))}}while(n);break}if(o.name==="c-model-html"){const n=r(t(o.value,u));n!==undefined&&e.html(n);break}if(e.is(":input")){const n=t(o.value,u);n!==undefined&&e.setModelValue(n)}else{const n=r(t(o.value,u));n!==undefined&&e.text(n)}break}}});e&&e.constructor===Function&&e(this,u,o)}else{const r={};return n.each(s,function(u,f){const e=n(f);if(e.is(":input")||e.is("[contenteditable='true']"))for(let u=f.attributes.length-1;u>=0;u--){const o=f.attributes[u];if(o.name.startsWith("c-model")){if(o.name==="c-model-dazzle"){const u=a.exec(o.value)||v.exec(o.value);if(u){const o=u[1],f=u[2];if(t(f,r)===undefined){const t=e.getModelValue();t!==undefined&&(o==="value-number"?i(f,n.jqModel.toNumber(t),r):i(f,t,r))}}break}if(t(o.value,r)===undefined){const t=e.getModelValue();t!==undefined&&(o.name==="c-model-number"?i(o.value,n.jqModel.toNumber(t),r):i(o.value,t,r))}break}}}),r}return this},models:function(t,i,r){const u=this;if(u.length===0)return undefined;if(t)if(t.constructor===Object){const e=i,o=t[e].toString();for(let i=0;i<u.length;i++){const s=n(u[i]),h=f(s,e);if(h.getModelValue()===o){s.model(t,r);break}}}else if(t.constructor===Array){if(i.constructor===String){const e=i;n.each(t,function(t,i){const s=i[e].toString();let o=0;for(;o<u.length;o++){const h=n(u[o]),c=f(h,e);if(c.getModelValue()===s){h.model(i,r,undefined,t);break}}o<u.length&&u.splice(o,1)})}else if(i instanceof jQuery){const f=n(u);n.each(t,function(n,t){i.clone().model(t,r,undefined,n).appendTo(f)})}else if(i.constructor===Function){const f=n(u);n.each(t,function(n,t){i(t,n).clone().model(t,r,undefined,n).appendTo(f)})}}else{const r=t,e=i.toString();for(let t=0;t<u.length;t++){const i=n(u[t]),o=f(i,r);if(o.getModelValue()===e)return i.model()}}else{const t=[];return n.each(u,function(i,r){t.push(n(r).model())}),t}return this}})}(jQuery);